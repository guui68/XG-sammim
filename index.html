<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ListerPro - Ultra Premium Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; user-select: none; margin: 0; overflow-x: hidden; }
        
        /* ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ï‡¶ó‡ßç‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶° ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶® */
        .bg-glow {
            position: fixed; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.05) 0%, transparent 50%);
            z-index: -1; animation: rotate 20s linear infinite;
        }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* ‡¶Ü‡¶≤‡ßç‡¶ü‡ßç‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶° */
        #loginOverlay {
            position: fixed; inset: 0; z-index: 500; background: #000;
            display: flex; align-items: center; justify-content: center; transition: 0.5s;
        }
        .login-card {
            background: rgba(255, 255, 255, 0.01);
            backdrop-filter: blur(30px);
            padding: 3rem 2rem;
            border-radius: 3rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            width: 90%; max-width: 380px;
            text-align: center;
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.1);
            position: relative; overflow: hidden;
        }
        .login-card::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: conic-gradient(transparent, transparent, transparent, #3b82f6);
            animation: border-spin 4s linear infinite; z-index: -1;
        }
        .inner-card { background: #000; inset: 2px; position: absolute; border-radius: 3rem; z-index: -1; }

        @keyframes border-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        .pass-input {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #fff; padding: 1.2rem; border-radius: 1.5rem; width: 100%;
            text-align: center; font-size: 1.8rem; letter-spacing: 6px;
            outline: none; transition: 0.3s; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
        }
        .pass-input:focus { border-color: #3b82f6; box-shadow: 0 0 20px rgba(59, 130, 246, 0.3); }

        /* ‡¶Æ‡ßá‡¶á‡¶® ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® */
        #appContent { display: none; }
        .sticky-header { position: sticky; top: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 100; padding: 10px 0; }
        .user-card { 
            background: linear-gradient(145deg, #0a0a0a, #050505);
            border: 1px solid #111; border-radius: 20px; margin-bottom: 12px;
            transition: 0.2s; position: relative; overflow: hidden;
        }
        .success-tag { position: absolute; top: 0; right: 0; background: #10b981; color: #000; font-size: 8px; font-weight: 900; padding: 3px 12px; border-bottom-left-radius: 12px; }
        
        .tab-btn { transition: 0.3s; color: #444; font-size: 14px; font-weight: 800; padding-bottom: 6px; border-bottom: 2px solid transparent; }
        .tab-btn.active { color: #3b82f6; border-bottom-color: #3b82f6; }

        /* ‡¶π‡ßã‡¶≤‡ßç‡¶° ‡¶™‡ßç‡¶∞‡¶ó‡ßç‡¶∞‡ßá‡¶∏ ‡¶¨‡¶æ‡¶∞ */
        @keyframes loading { from { width: 0%; } to { width: 100%; } }
        .pressing { position: absolute; bottom: 0; left: 0; height: 4px; background: #3b82f6; animation: loading 1.5s linear forwards; }
        
        .modal { display: none; position: fixed; inset: 0; z-index: 600; align-items: center; justify-content: center; background: rgba(0,0,0,0.95); backdrop-filter: blur(15px); }
        .active-modal { display: flex; }
    </style>
</head>
<body>

    <div class="bg-glow"></div>

    <div id="loginOverlay">
        <div class="login-card">
            <div class="inner-card"></div>
            <div class="w-20 h-20 bg-gradient-to-tr from-blue-600 to-blue-400 rounded-3xl mx-auto mb-6 flex items-center justify-center shadow-xl shadow-blue-500/20">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
            </div>
            <h2 class="text-3xl font-black mb-1 tracking-tighter uppercase italic">Lister<span class="text-blue-500">Pro</span></h2>
            <p class="text-gray-500 text-xs mb-8 uppercase tracking-[3px]">System Encrypted</p>
            
            <input type="password" id="passCode" class="pass-input mb-6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="8">
            
            <button onclick="checkPass()" class="w-full bg-blue-600 py-4 rounded-2xl font-black text-lg shadow-lg shadow-blue-900/40 active:scale-95 transition-all">ACCESS SYSTEM</button>
            <p id="loginError" class="text-rose-500 text-xs mt-4 opacity-0 font-bold">WRONG PASSWORD!</p>
        </div>
    </div>

    <div id="appContent" class="p-4">
        <div class="max-w-md mx-auto">
            <div class="sticky-header">
                <input type="text" id="searchInput" oninput="renderData()" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." class="w-full p-5 bg-[#0a0a0a] border border-gray-800 rounded-[1.8rem] text-white outline-none focus:border-blue-600 mb-6 shadow-inner">
                
                <div class="flex justify-between items-center mb-6">
                    <h1 class="text-2xl font-black italic text-blue-600">LISTER<span class="text-white">PRO</span></h1>
                    <button onclick="openAddModal()" class="w-12 h-12 bg-white text-black rounded-full font-bold text-3xl shadow-xl active:rotate-90 transition-all">+</button>
                </div>

                <div class="grid grid-cols-3 gap-3 mb-6">
                    <div class="bg-[#050505] p-3 rounded-2xl border border-gray-900 text-center">
                        <p class="text-[8px] text-gray-600 font-black uppercase">Total</p>
                        <h2 id="totalCount" class="text-xl font-bold">0</h2>
                    </div>
                    <div class="bg-[#050505] p-3 rounded-2xl border border-gray-900 text-center">
                        <p class="text-[8px] text-emerald-600 font-black uppercase">Paid</p>
                        <h2 id="paidCount" class="text-xl font-bold text-emerald-500">0</h2>
                    </div>
                    <div class="bg-[#050505] p-3 rounded-2xl border border-gray-900 text-center">
                        <p class="text-[8px] text-rose-600 font-black uppercase">Due</p>
                        <h2 id="dueCount" class="text-xl font-bold text-rose-500">0</h2>
                    </div>
                </div>

                <div class="flex gap-8 px-2 border-b border-gray-900 overflow-x-auto whitespace-nowrap scrollbar-hide">
                    <button onclick="switchTab('all')" id="tab-all" class="tab-btn active">‡¶∏‡¶¨‡¶æ‡¶á</button>
                    <button onclick="switchTab('due')" id="tab-due" class="tab-btn">‡¶¨‡¶æ‡¶ï‡¶ø</button>
                    <button onclick="switchTab('paid')" id="tab-paid" class="tab-btn">‡¶™‡ßá‡¶á‡¶°</button>
                    <button onclick="openReportModal()" class="tab-btn text-orange-500">REPORT üì¢</button>
                </div>
            </div>

            <div id="userList" class="pb-32 mt-4"></div>
        </div>
    </div>

    <div id="actionModal" class="modal">
        <div class="bg-[#080808] w-[88%] p-8 rounded-[3rem] border border-gray-800 relative shadow-2xl">
            <button onclick="closeActionModal()" class="absolute -top-3 -right-3 w-12 h-12 bg-rose-600 text-white rounded-full font-bold border-4 border-black">X</button>
            <h3 id="targetName" class="text-center text-xl font-bold mb-8 italic text-blue-400">‡¶®‡¶æ‡¶Æ</h3>
            <div class="space-y-4">
                <button onclick="confirmDeleteUser()" class="w-full bg-rose-950/20 text-rose-500 p-5 rounded-2xl font-bold border border-rose-900/30 uppercase text-[10px] tracking-[2px]">üóë ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü</button>
                <button id="statusActionBtn" onclick="handleStatusToggle()" class="w-full bg-emerald-600 text-white p-5 rounded-2xl font-bold text-lg">‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏</button>
                <button onclick="handleEditClick()" class="w-full bg-gray-900 text-white p-5 rounded-2xl font-bold border border-gray-800">‡¶®‡¶æ‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</button>
            </div>
        </div>
    </div>

    <div id="dataModal" class="modal">
        <div class="bg-[#080808] w-[88%] p-10 rounded-[3rem] border border-gray-800">
            <input type="hidden" id="editId">
            <input type="text" id="userNameInput" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶®‡¶æ‡¶Æ..." class="w-full p-5 bg-black border border-gray-800 rounded-2xl text-center text-white mb-6 outline-none focus:border-blue-600 text-xl">
            <button onclick="saveUser()" class="w-full bg-white text-black p-5 rounded-2xl font-black uppercase tracking-widest">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button onclick="closeDataModal()" class="w-full text-gray-600 font-bold text-xs mt-6 uppercase text-center block">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
        </div>
    </div>

    <div id="reportModal" class="modal" onclick="if(event.target==this) closeReportModal()">
        <div class="bg-[#080808] w-[85%] p-8 rounded-[3rem] border border-gray-800">
            <div class="space-y-4">
                <button onclick="sendBulkReport('all')" class="w-full bg-blue-600 text-white p-5 rounded-2xl font-bold">‡¶∏‡¶¨‡¶æ‡¶á‡¶ï‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                <button onclick="sendBulkReport('due')" class="w-full bg-rose-600 text-white p-5 rounded-2xl font-bold">‡¶¨‡¶æ‡¶ï‡¶ø ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</button>
                <button onclick="sendBulkReport('paid')" class="w-full bg-emerald-600 text-white p-5 rounded-2xl font-bold">‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</button>
            </div>
        </div>
    </div>

    <script>
        const PIN = "78482302";
        const BOT_TOKEN = "7885791804:AAHQjsAsMuBfvVqWga0hub2m0QZ7BrgsAsc"; 
        const CHAT_ID = "5923885908";

        // ‡¶∏‡ßá‡¶∂‡¶® ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü (‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡¶≤‡ßá ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶ö‡¶æ‡¶á‡¶¨‡ßá)
        function checkPass() {
            const val = document.getElementById('passCode').value;
            const error = document.getElementById('loginError');
            if(val === PIN) {
                sessionStorage.setItem('lister_session', 'active');
                unlockApp();
            } else {
                error.style.opacity = '1';
                setTimeout(() => error.style.opacity = '0', 2000);
            }
        }

        function unlockApp() {
            document.getElementById('loginOverlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('appContent').style.display = 'block';
                renderData();
            }, 500);
        }

        // ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú
        const rawNames = ["‡¶ï‡¶æ‡¶ú‡¶≤","‡¶∏‡ßÅ‡¶®‡ßÄ‡¶≤","‡¶∂‡¶æ‡¶ì‡¶®","‡¶´‡¶∞‡¶ø‡¶¶","‡¶Ü‡¶á‡¶Ø‡¶º‡ßÅ‡¶¨","‡¶™‡¶æ‡¶∞‡¶≠‡ßá‡¶ú ‡ßß","‡¶¶‡¶ø‡¶™‡ßÅ","‡¶∂‡¶æ‡¶®‡ßç‡¶§‡¶ø","‡¶Ü‡¶≤‡¶æ‡¶Æ‡¶ø‡¶®","‡¶Æ‡¶ø‡¶ú‡¶æ‡¶®","‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞","‡¶∞‡ßã‡¶ï‡¶®","‡¶∂‡¶æ‡¶π‡¶æ‡¶¨‡ßÅ‡¶¶‡ßç‡¶¶‡¶ø‡¶®","‡¶ú‡¶®‡¶ø","‡¶Ö‡¶´‡¶ø‡¶∏","‡¶∞‡¶æ‡¶´‡¶ø‡¶®","‡¶¶‡ßÅ‡¶∞‡ßç‡¶ú‡¶Ø‡¶º","‡¶∏‡¶æ‡¶á‡¶´‡¶æ","‡¶ú‡ßá‡¶∞‡¶ø‡¶®","‡¶Æ‡¶æ‡¶π‡¶æ‡¶¶‡¶ø","‡¶∞‡¶ø‡¶¶‡¶Ø‡¶º ‡ßß","‡¶Æ‡ßã‡¶¨‡¶æ‡¶∞‡¶ï","‡¶á‡¶Æ‡¶® ‡ßß","‡¶á‡¶Æ‡¶∞‡¶æ‡¶®","‡¶Æ‡ßã‡¶¨‡¶æ‡¶∞‡¶ï ‡ß®","‡¶∞‡¶ø‡¶¶‡¶Ø‡¶º","‡¶Ü‡¶®‡¶®‡ßç‡¶¶","‡¶á‡¶Ø‡¶º‡¶æ‡¶ï‡ßÅ‡¶¨","‡¶®‡¶æ‡¶¨‡¶ø‡¶≤","‡¶ú‡¶æ‡¶ï‡¶ø‡¶∞ ‡ß®","‡¶∏‡¶æ‡¶ó‡¶∞","‡¶∂‡¶æ‡¶ï‡¶ø‡¶≤ ‡ß©","‡¶∞‡ßÅ‡¶∏‡ßç‡¶§‡¶Æ","‡¶π‡¶æ‡¶∂‡ßá‡¶Æ","‡¶Ü‡¶∂‡¶∞‡¶æ‡¶´‡ßÅ‡¶≤","‡¶¶‡ßÄ‡¶™‡ßç‡¶§","‡¶π‡¶æ‡¶Æ‡¶ø‡¶¶‡ßÅ‡¶≤","‡¶Ü‡¶ú‡¶æ‡¶π‡¶æ‡¶∞ ‡ßß","‡¶®‡¶¨‡¶æ‡¶¨","‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º","‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤","‡¶Æ‡ßã‡¶§‡¶æ‡¶≤‡ßá‡¶¨","‡¶è‡¶∏ ‡¶ï‡ßá ‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï","‡¶Ü‡¶ú‡¶æ‡¶π‡¶æ‡¶∞","‡¶ï‡¶æ‡¶∂‡ßá‡¶Æ ‡¶Ü‡¶Æ‡¶ø‡¶∞‡ßÅ‡¶≤","‡¶∞‡¶§‡¶® ‡ßß","‡¶∏‡¶™‡ßç‡¶®‡¶æ","‡¶¨‡¶æ‡¶¶‡¶≤","‡¶∞‡¶æ‡¶´‡ßá‡¶ú‡¶æ","‡¶∞‡ßá‡¶ú‡¶æ‡¶â‡¶≤","‡¶∏‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ","‡¶Æ‡¶æ‡¶∏‡ßÅ‡¶¶","‡¶Ü‡¶≤‡¶æ‡¶Æ‡¶ø‡¶® ‡ßß","‡¶Æ‡¶û‡ßç‡¶ú‡ßÅ ‡ßß","‡¶∏‡¶æ‡¶∞‡ßã‡¶Ø‡¶º‡¶æ‡¶∞","‡¶∏‡ßã‡¶π‡ßá‡¶≤","‡¶ù‡ßÅ‡¶Æ‡¶æ ‡ßß","‡¶ú‡¶∏‡¶ø‡¶Æ ‡ßß","‡¶∞‡ßã‡¶ï‡ßá‡¶Ø‡¶º‡¶æ","‡¶∏‡ßÅ‡¶Æ‡¶® ‡ß®","‡¶Æ‡ßã‡¶´‡¶æ‡¶ú‡ßç‡¶ú‡¶≤ ‡ßß","‡¶Æ‡ßã‡¶´‡¶æ‡¶ú‡ßç‡¶ú‡¶≤ ‡ß¶","‡¶∞‡¶æ‡¶Ø‡¶º‡¶π‡¶æ‡¶®","‡¶™‡¶≤‡¶æ‡¶∂","‡¶Æ‡¶æ‡¶≤‡ßá‡¶ï","‡¶Æ‡ßÅ‡¶∞‡¶æ‡¶¶","‡¶∏‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡ß®","‡¶ú‡ßÅ‡¶Ø‡¶º‡ßá‡¶≤ ‡ßß","‡¶Æ‡ßã‡¶ú‡¶æ‡¶Æ","‡¶∏‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∞","‡¶Ü‡¶∞‡¶æ‡¶´‡¶æ‡¶§","‡¶ú‡¶æ‡¶ï‡¶ø‡¶∞","‡¶ó‡ßã‡¶≤‡¶æ‡¶Æ ‡¶Æ‡ßã‡¶∏‡ßç‡¶§‡¶´‡¶æ","‡¶ú‡ßÅ‡¶≤‡¶π‡¶æ‡¶∏","‡¶â‡¶ú‡ßç‡¶ú‡¶≤","‡¶∏‡ßÅ‡¶Æ‡¶®","‡¶ú‡¶æ‡¶π‡¶æ‡¶ô‡ßç‡¶ó‡ßÄ‡¶∞ ‡ßß","‡¶ñ‡¶æ‡¶Ø‡¶º‡¶∞‡ßÅ‡¶≤ ‡ßß","‡¶ï‡¶æ‡¶ï‡¶®","‡¶∂‡¶æ‡¶ï‡¶ø‡¶≤ ‡ß®","‡¶π‡¶æ‡¶¨‡¶ø‡¶¨‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π","‡¶Ü‡¶ú‡¶ø‡¶ú","‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤","‡¶π‡¶æ‡¶∏‡¶æ‡¶®","‡¶Æ‡¶æ‡¶π‡¶ø","‡¶Æ‡¶æ‡¶á","‡¶∞‡ßÅ‡¶™‡¶æ","‡¶∏‡¶¨‡ßÅ‡¶ú","‡¶∏‡ßÅ‡¶Æ‡¶® ‡ßß","‡¶π‡¶¨‡¶ø","‡¶Ü‡¶≤‡¶æ‡¶Æ‡¶ø‡¶® ‡ß®","‡¶∏‡¶æ‡¶¶‡¶Æ‡¶æ‡¶®","‡¶∏‡ßã‡¶π‡ßá‡¶≤ ‡ß™","‡¶π‡¶æ‡¶≤‡¶ø‡¶Æ","‡¶Æ‡¶û‡ßç‡¶ú‡ßÅ","‡¶®‡ßÅ‡¶∞ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ","‡¶Ü‡¶ú‡¶π‡¶æ‡¶∞‡ßÅ‡¶≤","‡¶´‡¶∞‡¶π‡¶æ‡¶¶","‡¶´‡¶∞‡¶π‡¶æ‡¶¶ ‡ßß","‡¶∏‡ßá‡¶≤‡¶ø‡¶Æ","‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶ï‡¶§","‡¶ú‡¶π‡¶ø‡¶∞‡ßÅ‡¶≤","‡¶§‡¶æ‡¶®‡¶≠‡ßÄ‡¶∞","‡¶∞‡¶ø‡¶´‡¶æ‡¶§ ‡ß©","‡¶á‡¶Æ‡¶®","‡¶Ü‡¶∂‡¶ø‡¶ï‡ßÅ‡¶∞","‡¶∏‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ","‡¶∏‡ßã‡¶®‡¶ø‡¶Ø‡¶º‡¶æ ‡ß®","‡¶∏‡¶ø‡¶¶‡ßç‡¶¶‡¶ø‡¶ï","‡¶ú‡¶æ‡¶π‡¶æ‡¶ô‡ßç‡¶ó‡ßÄ‡¶∞","‡¶ú‡ßÅ‡¶¨‡¶æ‡¶Ø‡¶º‡ßá‡¶∞","‡¶™‡¶∞‡¶æ‡¶®","‡¶∏‡ßá‡¶≤‡¶ø‡¶Æ ‡¶≠‡¶æ‡¶á","‡¶Æ‡ßÅ‡¶Ø‡¶º‡¶æ‡¶ú","‡¶∂‡¶æ‡¶π‡ßÄ‡¶® ‡ßß","‡¶®‡ßÅ‡¶∞‡ßÅ‡¶≤ ‡¶Ü‡¶Æ‡¶ø‡¶®","‡¶Ö‡¶®‡¶ø‡¶ï","‡¶¶‡ßÅ‡¶≤‡¶æ‡¶≤","‡¶∞‡¶æ‡¶ú‡ßÅ","‡¶π‡ßÅ‡¶Æ‡¶æ‡¶Ø‡¶º‡ßÅ‡¶®","‡¶∞‡¶ø‡¶¶‡¶Ø‡¶º","‡¶Æ‡¶®‡¶ø‡¶∞","‡¶Æ‡ßã‡¶∂‡¶æ‡¶∞‡¶´","‡¶∏‡ßã‡¶®‡¶ø‡¶Ø‡¶º‡¶æ","‡¶∏‡¶æ‡¶ï‡¶ø‡¶¨‡ßÅ‡¶≤","‡¶∂‡¶æ‡¶®‡ßç‡¶§ ‡ß®","‡¶∞‡ßÅ‡¶¨‡ßá‡¶≤","‡¶™‡¶æ‡¶∞‡¶≠‡ßá‡¶ú","‡¶™‡¶≤‡¶æ‡¶∂","‡¶Æ‡¶æ‡¶∏‡ßÅ‡¶¶ ‡ßß","‡¶∏‡ßÅ‡¶Æ‡¶® ‡ß®","‡¶∂‡¶π‡ßÄ‡¶¶‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π","‡¶∞‡¶ø‡¶´‡¶æ‡¶§ ‡¶¨‡¶ø‡¶≤‡¶æ","‡¶∞‡¶Æ‡¶ú‡¶æ‡¶®","‡¶∞‡¶ø‡¶¶‡¶ì‡¶Ø‡¶º‡¶æ‡¶®","‡¶Ü‡¶≤‡¶Æ‡¶ó‡ßÄ‡¶∞","‡¶´‡¶æ‡¶∞‡ßÅ‡¶ï ‡ßß","‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï","‡¶´‡¶æ‡¶π‡¶ø‡¶Æ","‡¶∞‡¶æ‡¶∏‡ßá‡¶≤","‡¶∞‡¶ø‡¶Æ‡¶®","‡¶∂‡¶æ‡¶π‡¶æ‡¶®‡¶æ‡¶ú","‡¶π‡¶ø‡¶∞‡¶®","‡¶∏‡¶æ‡¶π‡¶æ‡¶®‡¶æ‡¶ú","‡¶Ü‡¶¨‡ßÅ‡¶¨‡¶ï‡ßç‡¶ï‡¶∞","‡¶¨‡¶ø‡¶≤‡¶ï‡¶ø‡¶∏","‡¶ú‡ßÅ‡¶Æ‡¶æ","‡¶Æ‡ßÅ‡¶∏‡ßá‡¶¶","‡¶°‡¶ø‡¶ï‡ßá ‡¶®‡¶æ‡¶π‡¶ø‡¶¶","‡¶∞‡¶Æ‡¶æ","‡¶∏‡ßÅ‡¶π‡ßá‡¶≤","‡¶∞‡¶æ‡¶ï‡¶ø‡¶¨","‡¶´‡¶æ‡¶∞‡ßÅ‡¶ï ‡ß®","‡¶∞‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤","‡¶®‡¶æ‡¶∏‡¶∞‡¶ø‡¶®","‡¶∏‡ßÅ‡¶ú‡¶®","‡¶∞‡¶π‡¶ø‡¶Æ","‡¶Ö‡¶™‡ßÅ","‡¶∂‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤","‡¶Æ‡¶ø‡¶≤‡ßç‡¶≤‡¶æ‡¶§","‡¶∞‡¶§‡¶®","‡¶π‡ßá‡¶≤‡¶æ‡¶≤","‡¶Ü‡¶®‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶¶‡¶ø‡¶¨‡¶æ","‡¶Ü‡¶∏‡¶ø‡¶´","‡¶∂‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤","‡¶Ü‡¶ú‡¶ø‡¶Æ‡¶â‡¶¶‡ßç‡¶¶‡¶ø‡¶®","‡¶ï‡¶æ‡¶â‡¶∏‡¶æ‡¶∞","‡¶ú‡¶∏‡¶ø‡¶Æ","‡¶Ü‡¶∏‡¶æ‡¶¶‡ßÅ‡¶≤","‡¶Æ‡ßÅ‡¶ú‡¶ø‡¶¨‡¶∞","‡¶∞‡¶ø‡¶¶‡ßü","‡¶Ü‡¶∏‡¶æ‡¶¶","‡¶Ö‡¶∞‡ßÅ‡¶£","‡¶∂‡¶∞‡¶ø‡¶´‡ßÅ‡¶≤","‡¶ñ‡ßã‡¶Å‡¶ú‡¶∞‡ßÅ‡¶≤ ‡¶Ü‡¶≤‡¶Æ","‡¶∂‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤ ‡ßß","‡¶π‡¶æ‡¶∞‡ßÅ‡¶®","‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡ßß","‡¶ú‡¶æ‡¶Æ‡¶æ‡¶≤","‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡ß®","‡¶Æ‡¶æ‡¶∞‡ßÅ‡¶´","‡¶∞‡¶æ‡¶∏‡ßá‡¶≤ ‡ß©","‡¶Æ‡¶ø‡¶®‡¶æ","‡¶ú‡¶æ‡¶≤‡¶æ‡¶≤","‡¶¶‡ßÅ‡¶≤‡¶æ‡¶≤","‡¶π‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶® ‡ßß","‡¶è‡¶Æ‡¶¶‡¶æ‡¶¶‡ßÅ‡¶≤","‡¶Æ‡ßã‡¶ï‡¶∏‡ßá‡¶¶‡ßÅ‡¶≤","‡¶´‡¶æ‡¶∞‡ßÅ‡¶ï","‡¶ú‡ßÅ‡¶Ø‡¶º‡ßá‡¶≤","‡¶Ü‡¶≤‡¶Æ ‡ßß","‡¶®‡¶æ‡¶à‡¶Æ","‡¶®‡¶æ‡¶¶‡¶ø‡¶Ø‡¶º‡¶æ","‡¶Ü‡¶ú‡¶ó‡¶∞","‡¶∞‡¶∂‡¶ø‡¶¶","‡¶∞‡¶æ‡¶∏‡ßá‡¶≤","‡¶§‡¶æ‡¶®‡¶æ ‡¶π‡¶æ‡¶Æ‡¶ø‡¶¶","‡¶ï‡¶æ‡¶≤‡¶æ‡¶Æ","‡¶∂‡ßÅ‡¶≠","‡¶π‡ßÅ‡¶Æ‡¶æ‡¶Ø‡¶º‡ßÅ‡¶®","‡¶Æ‡ßÅ‡¶ï‡ßÅ‡¶≤","‡¶Æ‡¶ø‡¶ú‡¶æ‡¶®","‡¶™‡¶æ‡¶∞‡¶≠‡ßá‡¶ú","‡¶Æ‡¶ø‡¶Æ","‡¶Ü‡¶≤‡¶Æ","‡¶π‡¶ø‡¶∂‡¶æ‡¶Æ","‡¶¶‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶∞","‡¶â‡¶ú‡ßç‡¶ú‡¶≤","‡¶∞‡¶´‡¶ø‡¶ï ‡ßß","‡¶áasm‡¶æ‡¶á‡¶≤","‡¶Ü‡¶®‡¶ø‡¶∏","‡¶∞‡ßÅ‡¶®‡ßÅ","‡¶Æ‡¶æ‡¶Æ‡ßÅ‡¶® ‡ßß","‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§","‡¶Æ‡¶û‡ßç‡¶ú‡ßÅ ‡ßß","‡¶Æ‡¶®‡¶ø‡¶∞","‡¶∞‡ßã‡¶ú‡¶æ","‡¶ï‡¶æ‡¶Æ‡¶∞‡ßÅ‡¶≤","‡¶Æ‡¶®‡¶ø‡¶∞ ‡ß®","‡¶ú‡¶æ‡¶ï‡¶ø‡¶∞ ‡ß©","‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶æ","‡¶∏‡ßã‡¶π‡¶æ‡¶ó","‡¶Ü‡¶∞‡¶ø‡¶´","‡¶§‡ßÅ‡¶π‡¶ø‡¶®","‡¶Æ‡ßã‡¶¨‡¶æ‡¶∞‡¶ï ‡ß©","‡¶´‡¶æ‡¶∞‡ßÅ‡¶ï","‡¶™‡¶≤‡¶æ‡¶∂","‡¶Æ‡¶Æ‡¶ø‡¶¶‡ßÅ‡¶≤","‡¶∞‡¶ø‡¶™‡¶®","‡¶∞‡ßã‡¶ï‡¶®","‡¶Ü‡¶∏‡¶ø‡¶´ ‡ßß","‡¶∏‡ßÅ‡¶Æ‡¶®","‡¶ñ‡¶æ‡¶≤‡ßá‡¶ï","‡¶Æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶Æ","‡¶∞‡¶æ‡¶ú‡¶ø‡¶¨","‡¶∂‡¶æ‡¶π‡ßÄ‡¶®","‡¶§‡¶æ‡¶Æ‡¶ø‡¶Æ","‡¶∂‡¶ø‡¶™‡¶®","‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨","‡¶Ü‡¶≤ ‡¶∞‡¶æ‡¶ú‡¶ø","‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø ‡ßß","‡¶∞‡ßã‡¶ú‡¶æ","‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶¶","‡¶∏‡ßã‡¶π‡ßá‡¶≤","‡¶∂‡¶´‡¶ø‡¶ï‡ßÅ‡¶≤ ‡ßß","‡¶∞‡¶ø‡¶¶‡ßü‡ß®","‡¶®‡¶æ‡¶à‡¶Æ","‡¶ñ‡¶æ‡¶á‡¶∞‡ßÅ‡¶≤ ‡ß®","‡¶Æ‡¶®‡¶ø‡¶∞","‡¶Æ‡ßã‡¶∂‡¶æ‡¶∞‡¶´ ‡ßß","‡¶∏‡¶™‡ßç‡¶®‡¶æ","‡¶ï‡¶æ‡¶´‡¶ø","‡¶∂‡¶∞‡¶ø‡¶´‡ßÅ‡¶≤ ‡ßß","‡¶Æ‡¶∞‡ßç‡¶ú‡¶ø‡¶®‡¶æ","‡¶Ü‡¶≤‡¶ø‡¶Æ","‡¶∞‡¶æ‡¶∂‡ßá‡¶¶","‡¶ú‡¶∏‡¶ø‡¶Æ ‡ß®","‡¶∏‡ßÅ‡¶≤‡¶§‡¶æ‡¶®‡¶æ","‡¶∂‡¶æ‡¶Æ‡ßÄ‡¶Æ","‡¶Ü‡¶≤‡¶ø‡¶Æ","‡¶Æ‡ßÅ‡¶∏‡ßç‡¶§‡¶æ‡¶´‡¶ø‡¶ú‡ßÅ‡¶∞","‡¶Æ‡¶ø‡¶∞‡¶æ‡¶ú","‡¶∏‡ßÅ‡¶Æ‡¶®","‡¶Æ‡¶æ‡¶π‡¶æ‡¶¶‡¶ø","‡¶Ü‡¶≤‡¶æ‡¶Æ‡¶ø‡¶®","‡¶∂‡ßÅ‡¶≠","‡¶™‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤","‡¶™‡¶ø‡ßü‡¶æ‡¶≤","‡¶∞‡¶æ‡¶¨‡ßç‡¶¨‡¶ø","‡¶∞‡ßã‡¶π‡¶æ‡¶®","‡¶∞‡¶´‡¶ø‡¶ï","‡¶á‡¶Ø‡¶º‡¶æ‡¶∏‡¶ø‡¶®","‡¶∏‡ßã‡¶π‡ßá‡¶≤","‡¶Ö‡¶®‡ßç‡¶ü‡¶æ‡¶∞","‡¶ú‡¶π‡¶ø‡¶∞ ‡¶Æ‡¶æ‡¶Æ‡¶æ","‡¶¨‡¶æ‡¶¨‡¶≤‡ßÅ","‡¶ú‡¶Ø‡¶º"];

        let users = JSON.parse(localStorage.getItem('billingFinalV25')) || [];
        if (users.length === 0) {
            users = rawNames.map((n, i) => ({ id: Date.now() + i, name: n, isPaid: false }));
            localStorage.setItem('billingFinalV25', JSON.stringify(users));
        }

        let activeUserId = null, holdTimer, currentTab = 'all';

        async function sendToTelegram(msg) {
            return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(msg)}&parse_mode=Markdown`);
        }

        function onTouchStart(id, element) {
            activeUserId = id;
            const loader = document.createElement('div');
            loader.className = 'pressing';
            element.appendChild(loader);
            holdTimer = setTimeout(() => {
                const user = users.find(u => u.id === id);
                document.getElementById('targetName').innerText = user.name;
                document.getElementById('statusActionBtn').innerText = user.isPaid ? "‡¶¨‡¶æ‡¶ï‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®" : "‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏";
                document.getElementById('actionModal').classList.add('active-modal');
                if(navigator.vibrate) navigator.vibrate(50);
                loader.remove();
            }, 1500);
        }

        function onTouchEnd(element) {
            clearTimeout(holdTimer);
            const loader = element.querySelector('.pressing');
            if(loader) loader.remove();
        }

        function renderData() {
            const listDiv = document.getElementById('userList');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            let filtered = users.filter(u => {
                const matchTab = (currentTab === 'due') ? !u.isPaid : (currentTab === 'paid') ? u.isPaid : true;
                return matchTab && u.name.toLowerCase().includes(searchVal);
            });

            let html = '';
            filtered.forEach((u, index) => {
                html += `
                    <div class="user-card p-6 flex justify-between items-center" 
                         ontouchstart="onTouchStart(${u.id}, this)" ontouchend="onTouchEnd(this)" 
                         onmousedown="onTouchStart(${u.id}, this)" onmouseup="onTouchEnd(this)">
                        ${u.isPaid ? '<div class="success-tag">Success</div>' : ''}
                        <div class="flex items-center">
                            <span class="text-blue-500 font-black mr-4 text-xs tracking-tighter">${index + 1}.</span>
                            <h4 class="text-white font-bold text-lg ${u.isPaid ? 'opacity-20 line-through' : ''}">${u.name}</h4>
                        </div>
                        <div class="w-3 h-3 rounded-full ${u.isPaid ? 'bg-emerald-500 shadow-[0_0_12px_#10b981]' : 'bg-rose-600 shadow-[0_0_12px_#e11d48]'}"></div>
                    </div>`;
            });
            listDiv.innerHTML = html;
            document.getElementById('totalCount').innerText = users.length;
            document.getElementById('paidCount').innerText = users.filter(u => u.isPaid).length;
            document.getElementById('dueCount').innerText = users.filter(u => !u.isPaid).length;
        }

        async function handleStatusToggle() {
            const user = users.find(u => u.id === activeUserId);
            user.isPaid = !user.isPaid;
            saveAndRender();
            closeActionModal();
            if (user.isPaid) await sendToTelegram(`‚úÖ *‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏*\nüë§ ${user.name}\nüìÖ ${new Date().toLocaleDateString('bn-BD')}`);
        }

        async function sendBulkReport(type) {
            let list = (type === 'all') ? users : (type === 'due') ? users.filter(u => !u.isPaid) : users.filter(u => u.isPaid);
            if(list.length === 0) return alert("‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶ñ‡¶æ‡¶≤‡¶ø!");
            const chunkSize = 50;
            alert(`${list.length} ‡¶ú‡¶®‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá...`);
            for (let i = 0; i < list.length; i += chunkSize) {
                const chunk = list.slice(i, i + chunkSize);
                let text = `üì¢ *‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü (${type})*\n\n` + chunk.map((u, idx) => `${i + idx + 1}. ${u.name}`).join('\n');
                await sendToTelegram(text);
                await new Promise(r => setTimeout(r, 600));
            }
            alert("‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶∏‡¶´‡¶≤!");
            closeReportModal();
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-'+tab).classList.add('active');
            renderData();
        }

        function saveAndRender() { localStorage.setItem('billingFinalV25', JSON.stringify(users)); renderData(); }
        function closeActionModal() { document.getElementById('actionModal').classList.remove('active-modal'); }
        function openReportModal() { document.getElementById('reportModal').classList.add('active-modal'); }
        function closeReportModal() { document.getElementById('reportModal').classList.remove('active-modal'); }
        function openAddModal() { document.getElementById('editId').value=""; document.getElementById('userNameInput').value=""; document.getElementById('dataModal').classList.add('active-modal'); }
        function closeDataModal() { document.getElementById('dataModal').classList.remove('active-modal'); }
        function handleEditClick() { const user=users.find(u=>u.id===activeUserId); document.getElementById('editId').value=user.id; document.getElementById('userNameInput').value=user.name; closeActionModal(); document.getElementById('dataModal').classList.add('active-modal'); }
        function confirmDeleteUser() { if(confirm("‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡¶®?")) { users=users.filter(u=>u.id!==activeUserId); saveAndRender(); closeActionModal(); } }
        function saveUser() { const name=document.getElementById('userNameInput').value.trim(); const id=document.getElementById('editId').value; if(!name) return; if(id) users=users.map(u=>u.id==id?{...u,name}:u); else users.unshift({id:Date.now(),name,isPaid:false}); saveAndRender(); closeDataModal(); }

        window.onload = () => { 
            if(sessionStorage.getItem('lister_session') === 'active') {
                unlockApp();
            }
        };
    </script>
</body>
</html>
