<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>স্মার্ট বিলিং ম্যানেজার</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .modal { display: none; background: rgba(0,0,0,0.9); }
        .active-modal { display: flex; }
        /* বড় টিকমার্ক ডিজাইন */
        .check-box {
            width: 32px; height: 32px;
            border: 2px solid #3b82f6;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s;
        }
        .check-box.active { background: #10b981; border-color: #10b981; color: white; }
        /* ট্যাব বাটন স্টাইল */
        .tab-btn { border-radius: 12px; transition: 0.3s; }
        .tab-btn.active { background: #3b82f6; color: white; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4); }
    </style>
</head>
<body class="bg-black text-slate-100 font-sans min-h-screen">

    <div class="max-w-xl mx-auto p-4">
        <div class="grid grid-cols-3 gap-2 py-6 mb-4 border-b border-gray-900">
            <div class="text-center">
                <p class="text-[10px] text-gray-500 font-bold uppercase">মোট ইউজার</p>
                <h2 id="totalCount" class="text-2xl font-black">0</h2>
            </div>
            <div class="text-center">
                <p class="text-[10px] text-emerald-500 font-bold uppercase">পেইড</p>
                <h2 id="paidCount" class="text-2xl font-black text-emerald-500">0</h2>
            </div>
            <div class="text-center">
                <p class="text-[10px] text-rose-500 font-bold uppercase">বাকি</p>
                <h2 id="dueCount" class="text-2xl font-black text-rose-500">0</h2>
            </div>
        </div>

        <div class="flex bg-gray-900 p-1 rounded-2xl mb-6">
            <button onclick="switchTab('all')" id="tab-all" class="tab-btn active flex-1 py-3 font-bold text-xs">সব ইউজার (All)</button>
            <button onclick="switchTab('due')" id="tab-due" class="tab-btn flex-1 py-3 font-bold text-xs">বাকি (Due)</button>
            <button onclick="switchTab('paid')" id="tab-paid" class="tab-btn flex-1 py-3 font-bold text-xs">পেইড (Paid)</button>
        </div>

        <div class="flex gap-2 mb-8">
            <input type="text" id="search" onkeyup="renderData()" placeholder="নাম দিয়ে খুঁজুন..." class="flex-1 bg-gray-900 border border-gray-800 p-4 rounded-2xl outline-none focus:border-blue-500">
            <button onclick="toggleModal(true)" class="bg-blue-600 px-6 rounded-2xl font-bold text-xl">+</button>
        </div>

        <div id="userList" class="space-y-3 pb-24">
            </div>
    </div>

    <div id="userModal" class="modal fixed inset-0 z-50 items-center justify-center p-6">
        <div class="bg-gray-900 w-full max-w-sm p-6 rounded-3xl border border-gray-800 shadow-2xl">
            <h3 class="text-xl font-bold mb-6 text-blue-500">নতুন ইউজার অ্যাড</h3>
            <div class="space-y-4">
                <input type="text" id="userName" placeholder="নাম লিখুন" class="w-full p-4 bg-gray-800 border border-gray-700 rounded-xl outline-none">
                <input type="number" id="userAmount" placeholder="টাকা" class="w-full p-4 bg-gray-800 border border-gray-700 rounded-xl outline-none">
                <select id="userMonth" class="w-full p-4 bg-gray-800 border border-gray-700 rounded-xl outline-none">
                    <option>ফেব্রুয়ারি ২০২৬</option>
                    <option>মার্চ ২০২৬</option>
                </select>
                <div class="flex gap-2 pt-4">
                    <button onclick="addUser()" class="flex-1 bg-blue-600 p-4 rounded-xl font-bold active:scale-95 transition">সেভ করুন</button>
                    <button onclick="toggleModal(false)" class="bg-gray-800 px-6 rounded-xl font-bold">বাতিল</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let users = JSON.parse(localStorage.getItem('myAdvancedBilling')) || [];
        let currentTab = 'all';

        function toggleModal(show) {
            document.getElementById('userModal').classList.toggle('active-modal', show);
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');
            renderData();
        }

        function addUser() {
            const name = document.getElementById('userName').value.trim();
            const amount = document.getElementById('userAmount').value.trim();
            const month = document.getElementById('userMonth').value;

            if (!name || !amount) return alert("দয়া করে নাম ও টাকা লিখুন!");

            users.unshift({ id: Date.now(), name, amount, month, isPaid: false });
            saveAndRender();
            toggleModal(false);
            document.getElementById('userName').value = '';
            document.getElementById('userAmount').value = '';
        }

        function toggleStatus(id) {
            users = users.map(u => u.id === id ? { ...u, isPaid: !u.isPaid } : u);
            saveAndRender();
        }

        function deleteUser(id) {
            if(confirm("মুছে ফেলতে চান?")) {
                users = users.filter(u => u.id !== id);
                saveAndRender();
            }
        }

        function saveAndRender() {
            localStorage.setItem('myAdvancedBilling', JSON.stringify(users));
            renderData();
        }

        function renderData() {
            const listArea = document.getElementById('userList');
            const searchVal = document.getElementById('search').value.toLowerCase();
            listArea.innerHTML = '';

            // ফিল্টারিং লজিক
            let filtered = users.filter(u => u.name.toLowerCase().includes(searchVal));
            if (currentTab === 'due') filtered = filtered.filter(u => !u.isPaid);
            if (currentTab === 'paid') filtered = filtered.filter(u => u.isPaid);

            if(filtered.length === 0) {
                listArea.innerHTML = `<p class="text-center text-gray-700 py-10">কোন ডাটা পাওয়া যায়নি</p>`;
            }

            filtered.forEach(u => {
                listArea.innerHTML += `
                    <div class="bg-gray-900 border border-gray-800 p-5 rounded-3xl flex justify-between items-center transition-all ${u.isPaid ? 'border-emerald-500/30' : ''}">
                        <div class="flex items-center gap-4">
                            <div onclick="toggleStatus(${u.id})" class="check-box ${u.isPaid ? 'active' : ''}">
                                ${u.isPaid ? '✔' : ''}
                            </div>
                            <div>
                                <h4 class="font-bold ${u.isPaid ? 'text-gray-500 line-through' : 'text-white'}">${u.name}</h4>
                                <p class="text-[10px] text-gray-500">${u.amount} TK | ${u.month}</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="text-[8px] font-bold px-2 py-1 rounded-lg bg-black ${u.isPaid ? 'text-emerald-400' : 'text-rose-500'}">
                                ${u.isPaid ? 'পেইড' : 'বাকি'}
                            </span>
                            <button onclick="deleteUser(${u.id})" class="text-gray-700 hover:text-rose-600">✕</button>
                        </div>
                    </div>
                `;
            });

            // ড্যাশবোর্ড আপডেট
            const paidNum = users.filter(u => u.isPaid).length;
            document.getElementById('totalCount').innerText = users.length;
            document.getElementById('paidCount').innerText = paidNum;
            document.getElementById('dueCount').innerText = users.length - paidNum;
        }

        window.onload = renderData;
    </script>
</body>
</html>
