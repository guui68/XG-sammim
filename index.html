<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ListerPro - Secure Sync Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; user-select: none; }
        #loginOverlay { position: fixed; inset: 0; z-index: 1000; background: #000; display: flex; align-items: center; justify-content: center; }
        .login-card, .pass-card { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(25px); padding: 2.5rem; border-radius: 3rem; border: 1px solid rgba(255, 255, 255, 0.1); width: 90%; max-width: 380px; text-align: center; position: relative; }
        .login-card::before { content: ''; position: absolute; inset: -2px; background: conic-gradient(transparent, transparent, #3b82f6); animation: spin 4s linear infinite; z-index: -1; border-radius: 3.1rem; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .inner-bg { position: absolute; inset: 2px; background: #000; border-radius: 3rem; z-index: -1; }
        #appContent { display: none; }
        .user-card { background: #050505; border: 1px solid #111; border-radius: 20px; margin-bottom: 10px; position: relative; overflow: hidden; }
        .pressing { position: absolute; bottom: 0; left: 0; height: 4px; background: #3b82f6; animation: loading 1.5s linear forwards; }
        @keyframes loading { from { width: 0%; } to { width: 100%; } }
        .tab-btn { transition: 0.3s; color: #444; font-size: 13px; font-weight: 800; border-bottom: 2px solid transparent; padding-bottom: 5px; }
        .tab-btn.active { color: #3b82f6; border-bottom-color: #3b82f6; }
        .sticky-header { position: sticky; top: 0; background: #000; z-index: 100; padding-top: 10px; }
        .modal { display: none; position: fixed; inset: 0; z-index: 600; align-items: center; justify-content: center; background: rgba(0,0,0,0.96); backdrop-filter: blur(15px); }
        .active-modal { display: flex; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-card">
            <div class="inner-bg"></div>
            <div class="w-16 h-16 bg-blue-600 rounded-2xl mx-auto mb-6 flex items-center justify-center shadow-2xl">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>
            </div>
            <h2 class="text-2xl font-black italic mb-6 uppercase tracking-tighter">Lister Pro</h2>
            <input type="password" id="passCode" class="w-full bg-zinc-900 border border-zinc-800 p-4 rounded-2xl text-center text-2xl tracking-[5px] text-white outline-none mb-6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="8">
            <button onclick="checkPass()" class="w-full bg-blue-600 py-4 rounded-2xl font-bold active:scale-95 transition-all">ACCESS SYSTEM</button>
        </div>
    </div>

    <div id="passVerifyModal" class="modal">
        <div class="pass-card">
            <h2 id="verifyTitle" class="text-white font-black text-xl mb-4 italic uppercase">Verify Action</h2>
            <p id="verifyDesc" class="text-gray-400 text-[10px] mb-6 tracking-widest uppercase">‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶§‡ßç‡¶§‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®</p>
            <input type="password" id="universalPass" class="w-full bg-zinc-900 p-4 rounded-2xl text-center text-white text-2xl tracking-[8px] outline-none mb-6 border border-zinc-800" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="8">
            <div class="flex gap-4">
                <button onclick="closeVerifyModal()" class="w-1/2 bg-zinc-800 py-4 rounded-2xl font-bold text-xs">CANCEL</button>
                <button onclick="executeVerifiedAction()" class="w-1/2 bg-blue-600 py-4 rounded-2xl font-bold text-xs shadow-lg shadow-blue-900/40">CONFIRM</button>
            </div>
        </div>
    </div>

    <div id="appContent" class="p-4">
        <div class="max-w-md mx-auto">
            <div class="sticky-header">
                <div class="relative mb-6">
                    <input type="text" id="searchInput" oninput="renderData()" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." class="w-full p-5 bg-[#0a0a0a] border border-gray-800 rounded-[1.8rem] text-white outline-none focus:border-blue-600">
                    <button onclick="askUniversalPass('reset_all')" class="absolute right-4 top-1/2 -translate-y-1/2 w-8 h-8 bg-rose-600/20 text-rose-500 rounded-full border border-rose-500/30 font-black text-xs shadow-lg">‚úï</button>
                </div>
                
                <div class="flex justify-between items-center mb-6 px-2">
                    <h1 class="text-2xl font-black italic text-blue-600">LISTER<span class="text-white">PRO</span></h1>
                    <button onclick="openAddModal()" class="w-12 h-12 bg-white text-black rounded-full font-bold text-3xl shadow-lg">+</button>
                </div>

                <div class="grid grid-cols-3 gap-3 text-center mb-6">
                    <div class="bg-[#0a0a0a] p-3 rounded-2xl border border-gray-900">
                        <p class="text-[8px] text-gray-500 font-black uppercase">Total</p>
                        <h2 id="totalCount" class="text-xl font-bold">0</h2>
                    </div>
                    <div class="bg-[#0a0a0a] p-3 rounded-2xl border border-gray-900">
                        <p class="text-[8px] text-emerald-500 font-black uppercase text-glow">Paid</p>
                        <h2 id="paidCount" class="text-xl font-bold text-emerald-500">0</h2>
                    </div>
                    <div class="bg-[#0a0a0a] p-3 rounded-2xl border border-gray-900">
                        <p class="text-[8px] text-rose-500 font-black uppercase">Due</p>
                        <h2 id="dueCount" class="text-xl font-bold text-rose-500">0</h2>
                    </div>
                </div>

                <div class="flex gap-8 px-2 border-b border-gray-900 overflow-x-auto whitespace-nowrap mb-4">
                    <button onclick="switchTab('all')" id="tab-all" class="tab-btn active">‡¶∏‡¶¨‡¶æ‡¶á</button>
                    <button onclick="switchTab('due')" id="tab-due" class="tab-btn">‡¶¨‡¶æ‡¶ï‡¶ø</button>
                    <button onclick="switchTab('paid')" id="tab-paid" class="tab-btn">‡¶™‡ßá‡¶á‡¶°</button>
                    <button onclick="openReportModal()" class="tab-btn text-orange-500">REPORT üì¢</button>
                </div>
            </div>

            <div id="userList" class="pb-32 mt-4"></div>
        </div>
    </div>

    <div id="actionModal" class="modal">
        <div class="bg-[#080808] w-[88%] p-8 rounded-[3rem] border border-gray-800 relative shadow-2xl">
            <button onclick="closeActionModal()" class="absolute -top-3 -right-3 w-12 h-12 bg-rose-600 text-white rounded-full font-bold border-4 border-black">X</button>
            <h3 id="targetName" class="text-center text-xl font-bold mb-8 italic text-blue-400">‡¶®‡¶æ‡¶Æ</h3>
            <div class="space-y-4">
                <button onclick="askUniversalPass('delete')" class="w-full bg-rose-950/20 text-rose-500 p-5 rounded-2xl font-bold border border-rose-900/30 uppercase text-[10px] tracking-[2px]">üóë ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</button>
                <button id="statusActionBtn" onclick="askUniversalPass('toggle_status')" class="w-full bg-emerald-600 text-white p-5 rounded-2xl font-bold text-lg">‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏</button>
                <button onclick="handleEditClick()" class="w-full bg-gray-900 text-white p-5 rounded-2xl font-bold border border-gray-800">‡¶è‡¶°‡¶ø‡¶ü ‡¶®‡¶æ‡¶Æ</button>
            </div>
        </div>
    </div>

    <div id="dataModal" class="modal">
        <div class="bg-[#080808] w-[88%] p-8 rounded-[3rem] border border-zinc-800">
            <input type="hidden" id="editId">
            <input type="text" id="userNameInput" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ..." class="w-full p-5 bg-black border border-zinc-800 rounded-2xl text-center text-white mb-6 outline-none">
            <button onclick="saveUser()" class="w-full bg-white text-black p-5 rounded-2xl font-black uppercase tracking-widest">‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <script>
        const PIN = "78482302";
        const BOT_TOKEN = "7885791804:AAHQjsAsMuBfvVqWga0hub2m0QZ7BrgsAsc"; 
        const CHAT_ID = "5923885908";

        let users = JSON.parse(localStorage.getItem('billingFinalV50')) || [];
        let activeUserId = null, holdTimer, currentTab = 'all', pendingAction = null;

        // ‡¶Ö‡¶•‡ßá‡¶®‡ßç‡¶ü‡¶ø‡¶ï‡ßá‡¶∂‡¶®
        function checkPass() {
            if(document.getElementById('passCode').value === PIN) {
                sessionStorage.setItem('lister_auth', 'active');
                unlock();
            } else { alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
        }

        function unlock() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('appContent').style.display = 'block';
            renderData();
        }

        // ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü
        function askUniversalPass(actionType) {
            pendingAction = actionType;
            closeActionModal();
            document.getElementById('verifyTitle').innerText = 
                actionType === 'delete' ? "Confirm Delete" : 
                actionType === 'reset_all' ? "Reset All Users" : "Confirm Success";
            document.getElementById('passVerifyModal').classList.add('active-modal');
            document.getElementById('universalPass').focus();
        }

        function closeVerifyModal() {
            document.getElementById('passVerifyModal').classList.remove('active-modal');
            document.getElementById('universalPass').value = '';
            pendingAction = null;
        }

        function executeVerifiedAction() {
            if (document.getElementById('universalPass').value === PIN) {
                if (pendingAction === 'delete') deleteUser();
                else if (pendingAction === 'toggle_status') toggleStatus();
                else if (pendingAction === 'reset_all') resetAll();
                closeVerifyModal();
            } else { alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°!"); }
        }

        // ‡¶ï‡ßã‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶∏
        function deleteUser() {
            users = users.filter(u => u.id !== activeUserId);
            saveAndRender();
        }

        async function toggleStatus() {
            const user = users.find(u => u.id === activeUserId);
            user.isPaid = !user.isPaid;
            saveAndRender();
            if (user.isPaid) {
                const msg = `‚úÖ *‡¶¨‡¶ø‡¶≤ ‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏*\nüë§ ${user.name}\n‚è∞ ${new Date().toLocaleTimeString('bn-BD')}`;
                fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(msg)}&parse_mode=Markdown`);
            }
        }

        function resetAll() {
            if(confirm("‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ '‡¶¨‡¶æ‡¶ï‡¶ø' (Unpaid) ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
                users.forEach(u => u.isPaid = false);
                saveAndRender();
                alert("‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá '‡¶¨‡¶æ‡¶ï‡¶ø' ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
            }
        }

        function renderData() {
            const listDiv = document.getElementById('userList');
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            let filtered = users.filter(u => {
                const matchTab = (currentTab === 'due') ? !u.isPaid : (currentTab === 'paid') ? u.isPaid : true;
                return matchTab && u.name.toLowerCase().includes(searchVal);
            });

            listDiv.innerHTML = filtered.map((u, i) => `
                <div class="user-card p-6 flex justify-between items-center" 
                     ontouchstart="onTouchStart(${u.id}, this)" ontouchend="onTouchEnd(this)">
                    <div class="flex items-center">
                        <span class="text-blue-500 font-black mr-4 text-xs">${i + 1}.</span>
                        <h4 class="text-white font-bold text-lg ${u.isPaid ? 'opacity-20 line-through' : ''}">${u.name}</h4>
                    </div>
                    <div class="w-3 h-3 rounded-full ${u.isPaid ? 'bg-emerald-500 shadow-[0_0_10px_#10b981]' : 'bg-rose-600 shadow-[0_0_10px_#e11d48]'}"></div>
                </div>`).join('');

            document.getElementById('totalCount').innerText = users.length;
            document.getElementById('paidCount').innerText = users.filter(u => u.isPaid).length;
            document.getElementById('dueCount').innerText = users.filter(u => !u.isPaid).length;
        }

        function onTouchStart(id, element) {
            activeUserId = id;
            const loader = document.createElement('div');
            loader.className = 'pressing';
            element.appendChild(loader);
            holdTimer = setTimeout(() => {
                const user = users.find(u => u.id === id);
                document.getElementById('targetName').innerText = user.name;
                document.getElementById('statusActionBtn').innerText = user.isPaid ? "‡¶¨‡¶æ‡¶ï‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®" : "‡¶∏‡¶æ‡¶ï‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡ßÅ‡¶®";
                document.getElementById('actionModal').classList.add('active-modal');
                if(navigator.vibrate) navigator.vibrate(50);
                loader.remove();
            }, 1500);
        }

        function onTouchEnd(element) {
            clearTimeout(holdTimer);
            const loader = element.querySelector('.pressing');
            if(loader) loader.remove();
        }

        function saveAndRender() { localStorage.setItem('billingFinalV50', JSON.stringify(users)); renderData(); }
        function closeActionModal() { document.getElementById('actionModal').classList.remove('active-modal'); }
        function switchTab(t) { currentTab = t; document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active')); document.getElementById('tab-'+t).classList.add('active'); renderData(); }
        function openAddModal() { document.getElementById('editId').value=""; document.getElementById('userNameInput').value=""; document.getElementById('dataModal').classList.add('active-modal'); }
        function closeDataModal() { document.getElementById('dataModal').classList.remove('active-modal'); }
        function handleEditClick() { 
            const user = users.find(u => u.id === activeUserId);
            document.getElementById('editId').value = user.id;
            document.getElementById('userNameInput').value = user.name;
            closeActionModal();
            document.getElementById('dataModal').classList.add('active-modal');
        }
        function saveUser() {
            const name = document.getElementById('userNameInput').value.trim();
            const id = document.getElementById('editId').value;
            if(!name) return;
            if(id) users = users.map(u => u.id == id ? {...u, name} : u);
            else users.unshift({id: Date.now(), name, isPaid: false});
            saveAndRender();
            closeDataModal();
        }

        window.onload = () => { if(sessionStorage.getItem('lister_auth') === 'active') unlock(); };
    </script>
</body>
</html>
